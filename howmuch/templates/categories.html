<script type="text/javascript">

$(document).on('ready', function(){
    if(document.URL.split("/")[3]=="search"){
        $('#filtros').show();
    }
    
	$('.filtro').click(function(e){
		if(document.URL.split("/")[3]==""){
            $('#'+this.id).attr("href","search/"+this.id);
        }
        else if(document.URL.split("/")[3]=="search"){
            if(document.URL.indexOf("_"+this.id.split("_")[1]+"_")!=-1){
                if(document.URL.indexOf("_",document.URL.indexOf("_"+this.id.split("_")[1]+"_")+this.id.split("_")[1].length+2)!=-1){
                    window.location.assign(document.URL.split("_"+this.id.split("_")[1]+"_")[0]+this.id+"_"+document.URL.split("_"+this.id.split("_")[1]+"_")[1].substr(document.URL.split("_"+this.id.split("_")[1]+"_")[1].indexOf("_")+1));
                }
                else{
                    $('#'+this.id).attr("href",document.URL.split("_"+this.id.split("_")[1]+"_")[0]+this.id);
                }
            }
            else{
                window.location.assign(document.URL.split("/")[0]+"/"+document.URL.split("/")[1]+"/"+document.URL.split("/")[2]+"/search/"+document.URL.split("/")[4]+this.id);
            }
        }
        else{
            window.location.assign(document.URL.split("/")[0]+"/"+document.URL.split("/")[1]+"/"+document.URL.split("/")[2]+"/search/"+this.id);
        }
	});

    $('#range').submit(function(e){
        e.preventDefault();
        this.id="_rangePrice_"+$('#min').attr("value")+"to"+$('#max').attr("value");
        if(document.URL.indexOf("_"+this.id.split("_")[1]+"_")!=-1){
                if(document.URL.indexOf("_",document.URL.indexOf("_"+this.id.split("_")[1]+"_")+this.id.split("_")[1].length+2)!=-1){
                    window.location.assign(document.URL.split("_"+this.id.split("_")[1]+"_")[0]+this.id+"_"+document.URL.split("_"+this.id.split("_")[1]+"_")[1].substr(document.URL.split("_"+this.id.split("_")[1]+"_")[1].indexOf("_")+1));
                }
                else{
                    window.location.assign(document.URL.split("_"+this.id.split("_")[1]+"_")[0]+this.id);
                }
        }
        else{
            window.location.assign(document.URL.split("/")[0]+"/"+document.URL.split("/")[1]+"/"+document.URL.split("/")[2]+"/search/"+document.URL.split("/")[4]+this.id);
        }
    });

    {% for cat in cats %}
        cat_name="{{ cat }}".split("&#39;")[1];
        cat_matches="{{ cat }}".split(",")[1].split(")")[0].trim();
        $('#_category_'+cat_name).text($('#_category_'+cat_name).text().split("(")[0]+"("+cat_matches+")");
    {% endfor %}

    {% for rp in rangePrice %}
        rp_name="{{ rp }}".split("&#39;")[1];
        rp_matches="{{ rp }}".split(",")[1].split(")")[0].trim();
        $('#_rangePrice_'+rp_name).text($('#_rangePrice_'+rp_name).text().split("(")[0]+"("+rp_matches+")");
    {% endfor %}

    {% if searchresults %}
    if($('._category_videojuegos').text().split("(")[1].charAt(0)=='0'){
        $('._category_videojuegos').hide();
    }
    if($('._category_hogar').text().split("(")[1].charAt(0)=='0'){
        $('._category_hogar').hide();
    }
    if($('._category_electrodomesticos').text().split("(")[1].charAt(0)=='0'){
        $('._category_electrodomesticos').hide();
    }
    if($('._category_peliculas-series-dvds').text().split("(")[1].charAt(0)=='0'){
        $('._category_peliculas-series-dvds').hide();
    }
    if($('._category_electronica-accesorios').text().split("(")[1].charAt(0)=='0'){
        $('._category_electronica-accesorios').hide();
    }
    if($('._category_celulares-accesorios').text().split("(")[1].charAt(0)=='0'){
        $('._category_celulares-accesorios').hide();
    }
    if($('._category_ropa-accesorios').text().split("(")[1].charAt(0)=='0'){
        $('._category_ropa-accesorios').hide();
    }
    if($('._category_libros-revistas').text().split("(")[1].charAt(0)=='0'){
        $('._category_libros-revistas').hide();
    }
    if($('._category_coleccionables').text().split("(")[1].charAt(0)=='0'){
        $('._category_coleccionables').hide();
    }
    if($('._category_computacion-accesorios').text().split("(")[1].charAt(0)=='0'){
        $('._category_computacion-accesorios').hide();
    }
    if($('._category_instrumentos-musicales').text().split("(")[1].charAt(0)=='0'){
        $('._category_instrumentos-musicales').hide();
    }
    if($('._category_juguetes').text().split("(")[1].charAt(0)=='0'){
        $('._category_juguetes').hide();
    }
    if($('._category_joyas-relojes').text().split("(")[1].charAt(0)=='0'){
        $('._category_joyas-relojes').hide();
    }
    if($('._rangePrice_0to500').text().split("(")[1].charAt(0)=='0'){
        $('._rangePrice_0to500').hide();
    }
    if($('._rangePrice_500to1000').text().split("(")[1].charAt(0)=='0'){
        $('._rangePrice_500to1000').hide();
    }
    if($('._rangePrice_1000to5000').text().split("(")[1].charAt(0)=='0'){
        $('._rangePrice_1000to5000').hide();
    }
    if($('._rangePrice_gte5000').text().split("(")[1].charAt(0)=='0'){
        $('._rangePrice_gte5000').hide();
    }
    {% endif %}
});
</script>

<section class="dropdown-menu-generic">
	<ul class="wrapper-div">
        {% if searchresults %}
        <li class="color7 _category_videojuegos"><a id="_category_videojuegos" class="filtro" href="#">Videojuegos (0)</a>
        </li>
        <li class="color7 _category_hogar"><a id="_category_hogar" class="filtro" href="#">Hogar (0)</a>
        </li>
        <li class="color7 _category_electrodomesticos"><a id="_category_electrodomesticos" class="filtro" href="#">Electrodomésticos (0)</a>
        </li>
        <li class="color7 _category_peliculas-series-dvds"><a id="_category_peliculas-series-dvds" class="filtro" href="#">Películas, series y DVDs (0)</a>
        </li>
        <li class="color7 _category_electronica-accesorios"><a id="_category_electronica-accesorios" class="filtro" href="#">Electrónica y Accesorios (0)</a>
        </li>
        <li class="color7 _category_celulares-accesorios"><a id="_category_celulares-accesorios" class="filtro" href="#">Celulares y Accesorios (0)</a>
        </li>
        <li class="color7 _category_ropa-accesorios"><a id="_category_ropa-accesorios" class="filtro" href="#">Ropa y Accesorios (0)</a>
        </li>
        <li class="color7 _category_libros-revistas"><a id="_category_libros-revistas" class="filtro" href="#">Libros y Revistas (0)</a>
        </li>
        <li class="color7 _category_coleccionables"><a id="_category_coleccionables" class="filtro" href="#">Coleccionables (0)</a>
        </li>
        <li class="color7 _category_computacion-accesorios"><a id="_category_computacion-accesorios" class="filtro" href="#">Computación y Accesorios (0)</a>
        </li>
        <li class="color7 _category_instrumentos-musicales"><a id="_category_instrumentos-musicales" class="filtro" href="#">Instrumentos Musicales (0)</a>
        </li>
        <li class="color7 _category_juguetes"><a id="_category_juguetes" class="filtro" href="#">Juguetes (0)</a>
        </li>
        <li class="color7 _category_joyas-relojes"><a id="_category_joyas-relojes" class="filtro" href="#">Joyas y Relojes (0)</a>
        </li>
        {% else %}
		<li class="color7 _category_videojuegos"><a id="_category_videojuegos" class="filtro" href="#">Videojuegos </a>
		</li>
		<li class="color7 _category_hogar"><a id="_category_hogar" class="filtro" href="#">Hogar </a>
		</li>
		<li class="color7 _category_electrodomesticos"><a id="_category_electrodomesticos" class="filtro" href="#">Electrodomésticos </a>
		</li>
		<li class="color7 _category_peliculas-series-dvds"><a id="_category_peliculas-series-dvds" class="filtro" href="#">Películas, series y DVDs </a>
		</li>
		<li class="color7 _category_electronica-accesorios"><a id="_category_electronica-accesorios" class="filtro" href="#">Electrónica y Accesorios </a>
		</li>
		<li class="color7 _category_celulares-accesorios"><a id="_category_celulares-accesorios" class="filtro" href="#">Celulares y Accesorios </a>
		</li>
		<li class="color7 _category_ropa-accesorios"><a id="_category_ropa-accesorios" class="filtro" href="#">Ropa y Accesorios </a>
		</li>
		<li class="color7 _category_libros-revistas"><a id="_category_libros-revistas" class="filtro" href="#">Libros y Revistas </a>
		</li>
		<li class="color7 _category_coleccionables"><a id="_category_coleccionables" class="filtro" href="#">Coleccionables </a>
		</li>
		<li class="color7 _category_computacion-accesorios"><a id="_category_computacion-accesorios" class="filtro" href="#">Computación y Accesorios </a>
		</li>
		<li class="color7 _category_instrumentos-musicales"><a id="_category_instrumentos-musicales" class="filtro" href="#">Instrumentos Musicales </a>
		</li>
		<li class="color7 _category_juguetes"><a id="_category_juguetes" class="filtro" href="#">Juguetes </a>
		</li>
		<li class="color7 _category_joyas-relojes"><a id="_category_joyas-relojes" class="filtro" href="#">Joyas y Relojes </a>
		</li>
        {% endif %}
        <div id="filtros" style="display:none;">
            <li class="color7"><b>Rango de precios</b></a>
            </li>
            <li class="color7 _rangePrice_0to500"><a id="_rangePrice_0to500" class="filtro" href="#">Hasta $500 (0)</a>
            </li>
            <li class="color7 _rangePrice_500to1000"><a id="_rangePrice_500to1000" class="filtro" href="#">$500 a $1000 (0)</a>
            </li>
            <li class="color7 _rangePrice_1000to5000"><a id="_rangePrice_1000to5000" class="filtro" href="#">$1000 a $5000 (0)</a>
            </li>
            <li class="color7 _rangePrice_gte5000"><a id="_rangePrice_gte5000" class="filtro" href="#">Más de $5000 (0)</a>
            </li>
            <li class="color7">
                <form id="range" action="/search">
                    <input id="min" type="text" placeholder="Min." style="width:60px">-<input id="max" type="text" placeholder="Máx." style="width:60px">&nbsp;&nbsp;<button class="btn btn-small" type="submit"><i class="icon-chevron-right"></i></button>
                </form>
            </li>
        </div>
	</ul>
</section>